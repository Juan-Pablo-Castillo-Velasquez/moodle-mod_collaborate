define ("mod_collaborate/settings",["jquery","core/str","core/templates"],function(a,b,c){return{init:function init(c){var d=!1,e={},f=function(b){for(var c in b){var d=b[c],e=""+a("#id_s_collaborate_"+d).val().trim();if(""===e){return!1}}return!0},g=function(){return f(["restserver","restkey","restsecret"])},h=function(){return f(["server","username","password"])},i=function(b,c,d,f){var g=e[b],h=a("#api_diag .noticetemplate_"+c).children().first().clone();a(h).addClass(d);a(h).addClass(f);a(h).html("<span class=\"api-connection-msg\">"+f+" - "+g+"</span>");a("#api_diag .api-connection-status .undefined").remove();a("#api_diag .api-connection-status ."+f).remove();a("#api_diag .api-connection-status").append(a(h))},j=function(){var b;if(g()){i("verifyingapi","message","spinner","REST");b={server:a("#id_s_collaborate_restserver").val().trim(),restkey:a("#id_s_collaborate_restkey").val().trim(),restsecret:a("#id_s_collaborate_restsecret").val()};b.contextid=c;a.ajax({url:M.cfg.wwwroot+"/mod/collaborate/testapi.php",context:document.body,data:b,success:function success(a){if(a.success){if(!d){i("connectionverified","success","","REST")}else{i("connectionverifiedchanged","success","","REST")}}else{i("connectionfailed","problem","","REST")}},error:function error(){i("connectionfailed","problem","","REST")}})}},k=function(){var b;if(h()){if(!g()){i("verifyingapi","message","spinner","SOAP")}b={server:a("#id_s_collaborate_server").val().trim(),username:a("#id_s_collaborate_username").val().trim(),password:a("#id_s_collaborate_password").val()};b.contextid=c;a.ajax({url:M.cfg.wwwroot+"/mod/collaborate/testapi.php",context:document.body,data:b,success:function success(b){if(b.success){if(!d){i("connectionverified","success","","SOAP")}else{i("connectionverifiedchanged","success","","SOAP")}a(".soapapisettings").css("display","block")}else{if(!g()){i("connectionfailed","problem","","SOAP")}}},error:function error(){if(!g()){i("connectionfailed","problem","","SOAP")}}})}},l=function(){a(".api_diag_btn").click(function(a){a.preventDefault();j();k()})},m=function(){a("#id_s_collaborate_server, #id_s_collaborate_username, #id_s_collaborate_password").keypress(function(){d=!0})};b.get_strings([{key:"connectionfailed",component:"mod_collaborate"},{key:"connectionverified",component:"mod_collaborate"},{key:"verifyingapi",component:"mod_collaborate"},{key:"connectionstatusunknown",component:"mod_collaborate"}]).then(function(b){e.connectionfailed=b[0];e.connectionverified=b[1];e.verifyingapi=b[2];e.connectionstatusunknown=b[3];m();l();if(g()){j()}if(h()){k()}if(/Edge\/\d./i.test(navigator.userAgent)||/MSIE/i.test(navigator.userAgent)||/Trident/i.test(navigator.userAgent)){a("fieldset[disabled=\"true\"] input").attr("disabled","true")}if(!g()){a(".soapapisettings").css("display","block")}})},uiinit:function uiinit(d){if(d&&5>d){var g="#page-mod-collaborate-mod section#region-main div[role='main']";if("snap"===M.cfg.theme){g="#page-mod-collaborate-mod main div[role='main']"}var h=document.querySelector(g);if(h){h.setAttribute("style","display: none;")}}var e=document.getElementById("id_largesessionenable"),f=new MutationObserver(function callback(d){for(var e in d){var f=d[e];if("attributes"===f.type&&"disabled"===f.attributeName){(function(){var d=a("[id=\"id_largesessionenable\"]"),e=d.is(":disabled");if(0<a(".collab-alert").length){a(".collab-alert").remove()}if(e){(function(){return b.get_strings([{key:"optionnotavailableforgroups",component:"mod_collaborate"}])})().then(function(a){if("snap"===M.cfg.theme){return c.render("theme_snap/form_alert",{type:"warning",classes:"collab-alert",message:a})}else{return"<div class=\"alert alert-warning collab-alert\" role=\"alert\">"+a+"</div>"}}).then(function(a){d.parent().parent().parent().append(a);if("snap"===M.cfg.theme){d.parent().parent().parent().addClass("mod-collaborate-dimmed-option")}})}else{if("snap"===M.cfg.theme){d.parent().parent().parent().removeClass("mod-collaborate-dimmed-option")}}})()}}});f.observe(e,{attributes:!0})}}});
//# sourceMappingURL=settings.min.js.map
